<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SharePoint Storage Optimization Project - Final Summary</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Inter', 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            line-height: 1.8;
            color: #cbd5e1;
            background: #0f172a;
            min-height: 100vh;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 40px 20px;
        }

        .header {
            text-align: center;
            background: linear-gradient(145deg, #1e293b 0%, #334155 100%);
            padding: 50px 40px;
            border-radius: 24px;
            margin-bottom: 40px;
            box-shadow: 
                0 25px 50px -12px rgba(0, 0, 0, 0.4),
                0 0 0 1px rgba(255, 255, 255, 0.05);
            position: relative;
            overflow: hidden;
        }

        .header::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: linear-gradient(45deg, #3b82f6, #8b5cf6, #06b6d4);
            opacity: 0.1;
            animation: shimmer 3s ease-in-out infinite alternate;
        }

        @keyframes shimmer {
            0% { opacity: 0.05; }
            100% { opacity: 0.15; }
        }

        .header h1 {
            font-size: 2.8rem;
            font-weight: 800;
            color: #f1f5f9;
            margin-bottom: 10px;
            background: linear-gradient(135deg, #3b82f6, #8b5cf6);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            position: relative;
            z-index: 1;
        }
        
        .main-content {
            background: linear-gradient(145deg, #1e293b, #334155);
            border-radius: 20px;
            padding: 40px 50px;
            box-shadow: 
                0 20px 40px -10px rgba(0, 0, 0, 0.4),
                0 0 0 1px rgba(255, 255, 255, 0.05);
        }

        h2 {
            font-size: 1.8rem;
            font-weight: 700;
            color: #f1f5f9;
            margin-top: 40px;
            margin-bottom: 20px;
            padding-bottom: 10px;
            border-bottom: 2px solid #334155;
        }
        
        h2:first-of-type {
            margin-top: 0;
        }

        h3 {
            font-size: 1.3rem;
            font-weight: 600;
            color: #e2e8f0;
            margin-top: 30px;
            margin-bottom: 15px;
        }

        p, ul, ol {
            margin-bottom: 20px;
            font-size: 1rem;
        }

        ul, ol {
            padding-left: 25px;
        }

        li {
            margin-bottom: 15px;
        }
        
        strong {
            color: #e2e8f0;
            font-weight: 600;
        }

        ul > li::marker {
            color: #3b82f6;
            font-weight: bold;
        }

        a {
            color: #60a5fa;
            text-decoration: none;
            font-weight: 500;
            transition: color 0.3s ease;
        }

        a:hover {
            color: #93c5fd;
            text-decoration: underline;
        }
        
        /* Styles for the code block placeholder */
        pre {
            background-color: #0f172a;
            border: 1px solid #334155;
            border-radius: 12px;
            padding: 20px;
            margin: 20px 0;
            overflow-x: auto;
            white-space: pre-wrap; /* Allows wrapping */
            word-wrap: break-word; /* Breaks long words */
            font-family: 'Consolas', 'Menlo', 'Courier New', monospace;
            font-size: 0.9rem;
            color: #e2e8f0;
        }
        
        pre code {
            font-family: inherit;
            color: inherit;
        }

        @media (max-width: 768px) {
            .container {
                padding: 20px 10px;
            }
            .header h1 {
                font-size: 2rem;
            }
            .main-content {
                padding: 30px 25px;
            }
        }
        
        /* Custom scrollbar */
        ::-webkit-scrollbar { width: 8px; }
        ::-webkit-scrollbar-track { background: #1e293b; }
        ::-webkit-scrollbar-thumb { background: linear-gradient(135deg, #3b82f6, #8b5cf6); border-radius: 4px; }
        ::-webkit-scrollbar-thumb:hover { background: linear-gradient(135deg, #2563eb, #7c3aed); }

    </style>
</head>
<body>
    <div class="container">
        <header class="header">
            <h1>Microsoft SharePoint Storage Optimization Project – Final Summary</h1>
        </header>

        <main class="main-content">
            <p>In response to growing storage capacity concerns, we initiated a SharePoint Storage Optimization Project to proactively manage and sustain our environment. Our analysis revealed that we are currently using 14.4 TB of storage, with approximately 43% of SharePoint sites flagged for cleanup. The project’s goal was to reduce unnecessary storage usage, enhance performance, and avoid potential cost escalation.</p>

            <h2>SharePoint Inventory Overview</h2>
            <ul>
                <li><strong>Total SharePoint Sites:</strong> 429</li>
                <li><strong>Teams-Integrated Sites:</strong> 191</li>
                <li><strong>Communication Sites:</strong> 238</li>
                <li><strong>Default Storage Limit:</strong> 25 TB per site</li>
                <li><strong>Retention Period:</strong> 7 years (OneDrive and SharePoint)</li>
            </ul>

            <h2>Work Summary and Key Observations</h2>
            <p>I would like to share a summary of the work completed as part of the SharePoint Storage Optimization Project, along with key findings and challenges encountered during the process. This has been a time-intensive and data-sensitive project, requiring significant effort and attention to detail. Below are the key highlights and observations.</p>
            
            <h3>Key Activities Performed</h3>
            <ol>
                <li>
                    <strong>Storage Usage Analysis Across SharePoint</strong>
                    <p>Collected and analysed detailed storage data across all SharePoint sites to identify high-usage areas, versioning impact, and overall consumption trends. This helped in understanding where optimization efforts would have the most impact. <a href="#">Click Here to view the SharePoint Site details.</a></p>
                </li>
                <li>
                    <strong>Standardized Site Storage Limits</strong>
                    <ul>
                        <li>By default, Microsoft allocates 25 TB of storage space when a new site is created. To address this, we modified the storage allocation method from automatic to manual. However, a key challenge was determining how to set manual storage limits for all sites efficiently and uniformly.</li>
                        <li>Implemented a default storage limit of 2 TB for all SharePoint sites to prevent unchecked growth and promote better space management.</li>
                        <li>PowerShell script was developed and executed to manually apply the storage limits to all existing SharePoint sites.</li>
                        <li>Storage alert notifications were enabled to automatically notify site owners when their site reaches 90% of the allocated limit, ensuring proactive management and timely action before the threshold is exceeded.</li>
                    </ul>
                    <pre><code><!-- Paste your PowerShell script for setting storage limits here -->
# Example: Connect-PnPOnline -Url $adminUrl -Interactive
# Get-PnPTenantSite | ForEach-Object {
#    Set-PnPTenantSite -Url $_.Url -StorageQuota 2097152 -StorageQuotaWarningLevel 1887436
# }
# Script content goes here...</code></pre>
                </li>
                <li>
                    <strong>Custom Script for Detailed Reporting</strong>
                    <p>Created a PowerShell script to generate an in-depth storage report. The script includes:</p>
                    <ul>
                        <li>Total site size</li>
                        <li>Version history size</li>
                        <li>Preservation Hold Library (PHL) size</li>
                    </ul>
                    <p>This provided a granular view of what's consuming storage and where potential optimizations could be applied.</p>
                     <pre><code><!-- Paste your PowerShell script for detailed reporting here -->
# Example: 
# $sites = Get-PnPTenantSite
# foreach ($site in $sites) {
#   # Logic to calculate and export size, version size, PHL size
# }
# Script content goes here...</code></pre>
                </li>
                <li>
                    <strong>Identification of Inactive Sites</strong>
                    <p>Compiled a list of sites that are no longer in use and currently consuming 0 MB of space. A plan was initiated to reach out to the site owners for confirmation, with the intent to decommission and delete these sites to recover unused resources. A SharePoint Site Life Cycle Management policy is being planned. According to this policy, inactive sites that have not been used for more than six months will be automatically moved to the archive.</p>
                </li>
                <li>
                    <strong>Testing the Impact of Retention Policy</strong>
                     <ul>
                        <li>Conducted a test by excluding a SharePoint test site from the 7-year retention policy.</li>
                        <li>Observed that once the site was excluded, the Preservation Hold Library (PHL) was automatically deleted, freeing up significant storage space.</li>
                        <li>This confirmed that the retention policy is directly responsible for retaining deleted and versioned data, even if versioning is disabled in the site settings.</li>
                        <li>Additionally, while analysing user activity, it was discovered that many users’ OneDrive accounts also contain large amounts of data under PHL, contributing to storage bloat.</li>
                        <li>Although clearing this data could significantly optimize storage, doing so is not permitted due to the organization's strict data retention compliance.</li>
                    </ul>
                </li>
                <li>
                    <strong>Versioning Configuration Optimized</strong>
                    <p>Initially, SharePoint sites were configured with the version history setting set to 'Automatic', which by default retained up to 500 versions of a document. To control storage usage, we switched from automatic to manual versioning and set the limit to 100 versions through the SharePoint UI. However, the UI restricts setting the limit below 100. To address this, a custom PowerShell script was developed that allows the version history limit to be set below 100 for any site. Based on InfoSec team guidance, the version history was standardized to retain a maximum of 15 versions. This setting was applied wherever applicable. However, due to the active retention policy with legal hold, we were unable to enforce this change in all environments. Documents under retention cannot have their version history or related metadata purged, limiting the full effectiveness of this adjustment. Despite this, the scripting mechanism is in place and ready for implementation wherever policy allows.</p>
                     <pre><code><!-- Paste your PowerShell script for versioning configuration here -->
# Example:
# $list = Get-PnPList -Identity "Documents"
# $list.MajorVersionLimit = 15
# $list.Update()
# Invoke-PnPQuery
# Script content goes here...</code></pre>
                </li>
                <li>
                    <strong>Alerts and Notifications Enabled</strong>
                    <p>Threshold-based storage alerts have been enabled, ensuring site owners are notified when their site approaches 90% of the assigned quota.</p>
                </li>
                <li>
                    <strong>SharePoint Tenant Level Storage Alert Automation Using n8n</strong>
                    <p>Previously, there was no alerting mechanism in place for monitoring SharePoint tenant-level storage usage. As a result, when the storage approached its maximum limit, IT administrators were not notified in time, potentially leading to service disruptions. To address this, an automated alerting system has been implemented using n8n, an open-source workflow automation tool.</p>
                    <h3>Key Features of the Automation:</h3>
                    <ul>
                        <li><strong>Automated Monitoring:</strong> The system continuously monitors the total SharePoint tenant storage, used storage, and remaining storage.</li>
                        <li><strong>Threshold-Based Alerts:</strong> When the storage usage reaches or exceeds 90%, an automated email notification is sent to it@netradyne.com to prompt immediate action.</li>
                        <li><strong>Daily Check Frequency:</strong> The workflow runs on a scheduled basis (e.g., daily) to ensure up-to-date usage statistics.</li>
                        <li><strong>Detailed Usage Metrics:</strong> The alert email includes:
                            <ul>
                                <li>Date of the check</li>
                                <li>Total storage allocated</li>
                                <li>Used storage</li>
                                <li>Remaining storage</li>
                                <li>Usage percentage</li>
                            </ul>
                        </li>
                        <li><strong>Scalable & Maintainable:</strong> The automation can be updated easily to modify thresholds, recipients, or add new logging or integrations.</li>
                    </ul>
                    <h3>Benefits:</h3>
                     <ul>
                        <li>Prevents unexpected service interruptions due to full storage.</li>
                        <li>Increases operational visibility and proactive management.</li>
                        <li>Ensures accountability through automated notifications.</li>
                    </ul>
                </li>
                <li>
                    <strong>Recycle Bin Monitoring Implemented</strong>
                    <p>Included periodic review and cleanup of Recycle Bin contents (both stages) to reclaim additional storage space.</p>
                </li>
                <li>
                    <strong>Unused File Cleanup</strong>
                    <p>Reports were generated to identify unused or large files not accessed in the last 12 months. Owners were advised for deletion or archival.</p>
                </li>
                <li>
                    <strong>Restricted Unmanaged Site Creation</strong>
                    <p>To avoid sprawl, self-service site creation was limited, and approvals were routed through IT for governance.</p>
                </li>
                 <li>
                    <strong>Audit and Logging for Storage Trends</strong>
                    <p>Enabled auditing to track site storage growth trends and support ongoing capacity planning and proactive actions.</p>
                </li>
            </ol>

            <h2>Challenges and Limitations</h2>
            <h3>Retention Policy Restrictions</h3>
            <ul>
                <li>Due to the mandatory 7-year retention policy, SharePoint does not allow purging of version history or PHL content during the retention period.</li>
                <li>Even if versioning settings are changed at the site level, the policy overrides them, meaning old versions and deleted content are still retained.</li>
                <li>This restricts the ability to fully implement certain storage-saving measures and limits the effectiveness of versioning adjustments.</li>
            </ul>

            <h2>Outcome</h2>
            <p>This initiative has helped optimize our SharePoint storage, reduce overhead, and bring governance into the content lifecycle. We will continue to monitor site usage and enforce best practices to maintain a healthy SharePoint environment.</p>
        </main>
    </div>
</body>
</html>
